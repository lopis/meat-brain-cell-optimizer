function a(){var b=n;b.l.G=b.G;b.l.F=b.F;b.l.B=b.B;b.l.M=b.M;let c=navigator.getGamepads()[0],d=b.h.get("KeyA")||b.h.get("ArrowLeft")||c?.buttons[14].pressed?-1:0,e=b.h.get("KeyD")||b.h.get("ArrowRight")||c?.buttons[15].pressed?1:0,h=b.h.get("KeyW")||b.h.get("ArrowUp")||c?.buttons[12].pressed?-1:0,k=b.h.get("KeyS")||b.h.get("ArrowDown")||c?.buttons[13].pressed?1:0;b.j.x=d+e||c?.axes[0]||0;b.j.y=h+k||c?.axes[1]||0;.1>Math.hypot(b.j.x,b.j.y)&&(b.j.x=0,b.j.y=0);b.G=0>b.j.y;b.F=0<b.j.y;b.B=!!(b.h.get("Enter")||
c?.buttons[0].pressed||c?.buttons[9].pressed);b.M=!(!b.h.get("Escape")&&!c?.buttons[8].pressed)}class p{constructor(){this.M=this.B=this.F=this.G=!1;this.h=new Map;this.l={G:this.G,F:this.F,B:this.B,M:this.M};document.addEventListener("keydown",b=>{this.h.set(b.code,!0)});document.addEventListener("keyup",b=>{this.h.set(b.code,!1)});this.j=new DOMPoint}}let n=new p;class q{constructor(...b){this.h=r;this.h.I?.(...b)}o(b,...c){this.h.N?.();this.h=b;this.h.I?.(...c)}}let t;var z=window.getComputedStyle(document.body);
let A=z.getPropertyValue("--color-0");z.getPropertyValue("--color-1");z.getPropertyValue("--color-2");z.getPropertyValue("--color-3");let B=z.getPropertyValue("--color-4"),C=z.getPropertyValue("--color-5");class M{constructor(){let b=()=>{c2d.height=c2d.clientHeight;c2d.width=c2d.clientWidth};window.addEventListener("resize",b);b()}}new M;var N={O:!0,title:"Great job",text:"Your test results are very promising."},O={O:!1,title:"Disappointing",text:"These results are not satisfactory. Try again."};
class P{constructor(){this.text=this.title="";this.O=!0;this.j=this.h=null;nextLevel.addEventListener("click",()=>{this.h&&t.o(this.h)});retry.addEventListener("click",()=>{this.j&&t.o(this.j)})}I(){resultTitle.innerText=this.title;resultText.innerText=this.text;result.classList.remove("hide");nextLevel.classList.toggle("hide",!this.O)}N(){result.classList.add("hide")}K(){}}
let Q=new P,R=(b,c=null,d=null)=>{Q.title=b.title;Q.text=b.text;Q.O=b.O;Q.h=c;Q.j=d;return Q},S={i:{},reset:b=>{S.canvas=b;S.ia=0;S.current={};S.next={};S.Y={};S.g=b.getContext("webgl2");S.g.blendFunc(770,771);S.g.activeTexture(33984);S.m=S.g.createProgram();S.g.enable(2884);S.g.shaderSource(b=S.g.createShader(35633),"#version 300 es\n      precision highp float;                        // Set default float precision\n      in vec4 pos, col, uv, normal;                 // Vertex attributes: position, color, texture coordinates, normal (if any)\n      uniform mat4 pv, eye, m, im;                  // Uniform transformation matrices: projection * view, eye, model, inverse model\n      uniform vec4 bb;                              // If the current shape is a billboard: bb = [w, h, 1.0, 0.0]\n      out vec4 v_pos, v_col, v_uv, v_normal;        // Varyings sent to the fragment shader: position, color, texture coordinates, normal (if any)\n      void main() {                                 \n        gl_Position = pv * (                        // Set vertex position: p * v * v_pos\n          v_pos = bb.z > 0.                         // Set v_pos varying:\n          ? m[3] + eye * (pos * bb)                 // Billboards always face the camera:  p * v * distance + eye * (position * [w, h, 1.0, 0.0])\n          : m * pos                                 // Other objects rotate normally:      p * v * m * position\n        );                                          \n        v_col = col;                                // Set varyings \n        v_uv = uv;\n        v_normal = transpose(inverse(m)) * normal;  // recompute normals to match model thansformation\n      }");
S.g.compileShader(b);S.g.attachShader(S.m,b);console.log("vertex shader:",S.g.getShaderInfoLog(b)||"OK");S.g.shaderSource(b=S.g.createShader(35632),"#version 300 es\n      precision highp float;                  // Set default float precision\n      in vec4 v_pos, v_col, v_uv, v_normal;   // Varyings received from the vertex shader: position, color, texture coordinates, normal (if any)\n      uniform vec3 light;                     // Uniform: light direction, smooth normals enabled\n      uniform vec4 o;                         // options [smooth, shading enabled, ambient, mix]\n      uniform sampler2D sampler;              // Uniform: 2D texture\n      out vec4 c;                             // Output: final fragment color\n\n      // The code below displays colored / textured / shaded fragments\n      void main() {\n        c = mix(texture(sampler, v_uv.xy), v_col, o[3]);  // base color (mix of texture and rgba)\n        if(o[1] > 0.){                                    // if lighting/shading is enabled:\n          c = vec4(                                       // output = vec4(base color RGB * (directional shading + ambient light)), base color Alpha\n            c.rgb * (max(0., dot(light, -normalize(       // Directional shading: compute dot product of light direction and normal (0 if negative)\n              o[0] > 0.                                   // if smooth shading is enabled:\n              ? vec3(v_normal.xyz)                        // use smooth normals passed as varying\n              : cross(dFdx(v_pos.xyz), dFdy(v_pos.xyz))   // else, compute flat normal by making a cross-product with the current fragment and its x/y neighbours\n            )))\n            + o[2]),                                      // add ambient light passed as uniform\n            c.a                                           // use base color's alpha\n          );\n        }\n      }");
S.g.compileShader(b);S.g.attachShader(S.m,b);console.log("fragment shader:",S.g.getShaderInfoLog(b)||"OK");S.g.linkProgram(S.m);S.g.useProgram(S.m);console.log("program:",S.g.getProgramInfoLog(S.m)||"OK");S.g.clearColor(1,1,1,1);S.clearColor=c=>S.g.clearColor(...S.W(c));S.clearColor("fff");S.g.enable(2929);S.ha({y:-1});S.A({L:30});setTimeout(S.aa,16)},o:(b,c,d)=>{let e;(e=b).n||(e.n="o"+S.ia++);b.size&&(b.w=b.J=b.d=b.size);b.t&&b.t.width&&!S.Y[b.t.id]&&(d=S.g.createTexture(),S.g.pixelStorei(37441,
!0),S.g.bindTexture(3553,d),S.g.pixelStorei(37440,1),S.g.texImage2D(3553,0,6408,6408,5121,b.t),S.g.generateMipmap(3553),S.Y[b.t.id]=d);b.L&&(S.ja=new DOMMatrix([1/Math.tan(b.L*Math.PI/180)/(S.canvas.width/S.canvas.height),0,0,0,0,1/Math.tan(b.L*Math.PI/180),0,0,0,0,-1001/999,-1,0,0,-2002/999,0]));b={type:c,...(S.current[b.n]=S.next[b.n]||{w:1,J:1,d:1,x:0,y:0,z:0,rx:0,ry:0,ca:0,b:"888",mode:4,T:0}),...b,f:0};S.i[b.type]?.D&&!S.i?.[b.type].da&&(S.g.bindBuffer(34962,S.i[b.type].da=S.g.createBuffer()),
S.g.bufferData(34962,new Float32Array(S.i[b.type].D),35044),!S.i[b.type].H&&S.smooth&&S.smooth(b),S.i[b.type].H&&(S.g.bindBuffer(34962,S.i[b.type].ba=S.g.createBuffer()),S.g.bufferData(34962,new Float32Array(S.i[b.type].H.flat()),35044)));S.i[b.type]?.P&&!S.i[b.type].Z&&(S.g.bindBuffer(34962,S.i[b.type].Z=S.g.createBuffer()),S.g.bufferData(34962,new Float32Array(S.i[b.type].P),35044));S.i[b.type]?.indices&&!S.i[b.type].S&&(S.g.bindBuffer(34963,S.i[b.type].S=S.g.createBuffer()),S.g.bufferData(34963,
new Uint16Array(S.i[b.type].indices),35044));b.t?b.t&&!b.T&&(b.T=0):b.T=1;S.next[b.n]=b},aa:(b,c,d,e,h=[])=>{c=b-S.ga;S.ga=b;requestAnimationFrame(S.aa);S.next?.A?.v&&S.X(S.next[S.next.A.v],c,1);d=S.animation("camera");S.next?.A?.v&&d.preMultiplySelf(S.next[S.next.A.v].V||S.next[S.next.A.v].s);S.g.uniformMatrix4fv(S.g.getUniformLocation(S.m,"eye"),!1,d.toFloat32Array());d.invertSelf();d.preMultiplySelf(S.ja);S.g.uniformMatrix4fv(S.g.getUniformLocation(S.m,"pv"),!1,d.toFloat32Array());S.g.clear(16640);
for(e in S.next)S.next[e].t||1!=S.W(S.next[e].b)[3]?h.push(S.next[e]):S.X(S.next[e],c);h.sort((k,m)=>S.$(m)-S.$(k));S.g.enable(3042);for(e of h)["plane","billboard"].includes(e.type)&&S.g.depthMask(0),S.X(e,c),S.g.depthMask(1);S.g.disable(3042);S.g.uniform3f(S.g.getUniformLocation(S.m,"light"),S.u("light","x"),S.u("light","y"),S.u("light","z"))},X:(b,c,d=["camera","light","group"].includes(b.type),e)=>{b.t&&(S.g.bindTexture(3553,S.Y[b.t.id]),S.g.uniform1i(S.g.getUniformLocation(S.m,"sampler"),0));
b.f<b.a&&(b.f+=c);b.f>b.a&&(b.f=b.a);S.next[b.n].s=S.animation(b.n);S.next[b.v]&&S.next[b.n].s.preMultiplySelf(S.next[b.v].V||S.next[b.v].s);S.g.uniformMatrix4fv(S.g.getUniformLocation(S.m,"m"),!1,(S.next[b.n].V||S.next[b.n].s).toFloat32Array());S.g.uniformMatrix4fv(S.g.getUniformLocation(S.m,"im"),!1,(new DOMMatrix(S.next[b.n].V||S.next[b.n].s)).invertSelf().toFloat32Array());d||(S.g.bindBuffer(34962,S.i[b.type].da),S.g.vertexAttribPointer(e=S.g.getAttribLocation(S.m,"pos"),3,5126,!1,0,0),S.g.enableVertexAttribArray(e),
S.i[b.type].Z&&(S.g.bindBuffer(34962,S.i[b.type].Z),S.g.vertexAttribPointer(e=S.g.getAttribLocation(S.m,"uv"),2,5126,!1,0,0),S.g.enableVertexAttribArray(e)),(b.ka||S.i[b.type].fa)&&S.i[b.type].ba&&(S.g.bindBuffer(34962,S.i[b.type].ba),S.g.vertexAttribPointer(e=S.g.getAttribLocation(S.m,"normal"),3,5126,!1,0,0),S.g.enableVertexAttribArray(e)),S.g.uniform4f(S.g.getUniformLocation(S.m,"o"),b.ka,(3<b.mode||3<S.g[b.mode])&&!b.U?1:0,S.ea||.2,b.T),S.g.uniform4f(S.g.getUniformLocation(S.m,"bb"),b.w,b.J,"billboard"==
b.type,0),S.i[b.type].S&&S.g.bindBuffer(34963,S.i[b.type].S),S.g.vertexAttrib4fv(S.g.getAttribLocation(S.m,"col"),S.W(b.b)),S.i[b.type].S?S.g.drawElements(+b.mode||S.g[b.mode],S.i[b.type].indices.length,5123,0):S.g.drawArrays(+b.mode||S.g[b.mode],0,S.i[b.type].D.length/3))},u:(b,c)=>S.next[b]?.a?S.current[b][c]+S.next[b].f/S.next[b].a*(S.next[b][c]-S.current[b][c]):S.next[b][c],animation:(b,c=new DOMMatrix)=>S.next[b]?c.translateSelf(S.u(b,"x"),S.u(b,"y"),S.u(b,"z")).rotateSelf(S.u(b,"rx"),S.u(b,
"ry"),S.u(b,"rz")).scaleSelf(S.u(b,"w"),S.u(b,"h"),S.u(b,"d")):c,$:(b,c=S.next.A)=>b?.s&&c?.s?(c.s.m41-b.s.m41)**2+(c.s.m42-b.s.m42)**2+(c.s.m43-b.s.m43)**2:0,ma:b=>S.ea=b,W:b=>[...b.replace("#","").match(5>b.length?/./g:/../g).map(c=>("0x"+c)/(5>b.length?15:255)),1],add:(b,c)=>{S.i[b]=c;c.H&&(S.i[b].fa=1);S[b]=d=>S.o(d,b)},group:b=>S.o(b,"group"),move:(b,c)=>setTimeout(()=>{S.o(b)},c||1),delete:(b,c)=>setTimeout(()=>{delete S.next[b]},c||1),A:(b,c)=>setTimeout(()=>{S.o(b,b.n="camera")},c||1),ha:(b,
c)=>c?setTimeout(()=>{S.o(b,b.n="light")},c):S.o(b,b.n="light"),smooth:(b,c={},d=[],e,h,k,m,l,g,f,D,E,F,y)=>{S.i[b.type].H=[];for(k=0;k<S.i[b.type].D.length;k+=3)d.push(S.i[b.type].D.slice(k,k+3));(e=S.i[b.type].indices)?h=1:(e=d,h=0);for(k=0;k<2*e.length;k+=3){m=k%e.length;l=d[D=h?S.i[b.type].indices[m]:m];g=d[E=h?S.i[b.type].indices[m+1]:m+1];f=d[F=h?S.i[b.type].indices[m+2]:m+2];let u=[g[0]-l[0],g[1]-l[1],g[2]-l[2]],v=[f[0]-g[0],f[1]-g[1],f[2]-g[2]];y=k>m?[0,0,0]:[u[1]*v[2]-u[2]*v[1],u[2]*v[0]-
u[0]*v[2],u[0]*v[1]-u[1]*v[0]];let G,H;(G=c)[H=l[0]+"_"+l[1]+"_"+l[2]]||(G[H]=[0,0,0]);let I,J;(I=c)[J=g[0]+"_"+g[1]+"_"+g[2]]||(I[J]=[0,0,0]);let K,L;(K=c)[L=f[0]+"_"+f[1]+"_"+f[2]]||(K[L]=[0,0,0]);S.i[b.type].H[D]=c[l[0]+"_"+l[1]+"_"+l[2]]=c[l[0]+"_"+l[1]+"_"+l[2]].map((w,x)=>w+y[x]);S.i[b.type].H[E]=c[g[0]+"_"+g[1]+"_"+g[2]]=c[g[0]+"_"+g[1]+"_"+g[2]].map((w,x)=>w+y[x]);S.i[b.type].H[F]=c[f[0]+"_"+f[1]+"_"+f[2]]=c[f[0]+"_"+f[1]+"_"+f[2]].map((w,x)=>w+y[x])}}};
S.add("plane",{D:[.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],P:[1,1,0,1,0,0,1,1,0,0,1,0]});
S.add("cube",{D:[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,-.5,-.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5],P:[1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,
1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0]});S.R=b=>{S.o(b,"cube")};S.add("pyramid",{D:[-.5,-.5,.5,.5,-.5,.5,0,.5,0,.5,-.5,.5,.5,-.5,-.5,0,.5,0,.5,-.5,-.5,-.5,-.5,-.5,0,.5,0,-.5,-.5,-.5,-.5,-.5,.5,0,.5,0,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5],P:[0,0,1,0,.5,1,0,0,1,0,.5,1,0,0,1,0,.5,1,0,0,1,0,.5,1,1,1,0,1,0,0,1,1,0,0,1,0]});
((b,c,d,e,h,k,m=[],l=[],g=[],f=20)=>{for(d=0;d<=f;d++)for(e=d*Math.PI/f,b=0;b<=f;b++)c=2*b*Math.PI/f,m.push(+(Math.sin(c)*Math.sin(e)/2).toFixed(6),+(Math.cos(e)/2).toFixed(6),+(Math.cos(c)*Math.sin(e)/2).toFixed(6)),g.push(3.5*Math.sin(b/f),-Math.sin(d/f)),b<f&&d<f&&l.push(h=d*(f+1)+b,k=h+(f+1),h+1,h+1,k,k+1);S.add("sphere",{D:m,P:g,indices:l})})();function T(b){document.removeEventListener("submit",b.l);submit.classList.add("clicked");setTimeout(()=>{t.o(R(N))},500)}
class U{constructor(){this.h=this.j=0;this.speed=-.5;this.counter=0;this.l=b=>{this.speed=2*(b?.target?.value-50)/100};this.C=()=>T(this)}I(){controls.classList.add("slide");range.value="25";S.reset(c2d);S.clearColor(B);S.A({y:.5,z:7,rx:-7,L:10});document.body.style.background=B;S.group({n:"G1",ry:0});S.R({v:"G1",w:1.5,J:1,d:1,x:0,y:0,U:1,b:A});S.group({n:"G2",ry:0});S.R({v:"G2",w:1.5,J:1,d:1,x:0,y:0,U:1,b:A});range.addEventListener("input",this.l);submit.addEventListener("click",this.C)}N(){S.reset(c2d);
S.clearColor(B);document.removeEventListener("input",this.l);controls.classList.remove("slide")}K(){this.j++;360<this.j&&(this.j-=360);S.move({n:"G1",ry:this.j});this.h+=this.speed;360<this.h?this.h-=360:0>this.h&&(this.h+=360);S.move({n:"G2",ry:this.h});this.counter++;if(20<this.counter){this.counter=0;let b=Math.round(5*Math.pow((1-Math.abs(1-this.speed))*(1-Math.abs(this.j%180-this.h%180)/180),5));for(let c=0;5>c;c++)lights.children[c].classList.toggle("on",b>=c+1)}}}let V=new U;
function W(b){document.removeEventListener("submit",b.j);submit.classList.add("clicked");setTimeout(()=>{t.o(R(5===b.C?N:O,V,b))},500)}
class aa{constructor(){this.C=this.counter=this.l=this.h=0;this.j=b=>{this.l=1.5*b?.target?.value/100};this.la=()=>W(this)}I(){controls.classList.add("slide");range.value="0";S.reset(c2d);S.clearColor(B);S.A({y:.5,z:7,rx:-7,L:10});document.body.style.background=B;S.group({n:"G1",ry:0});S.R({v:"G1",w:.1,J:1,d:.1,x:0,y:.5,U:1,b:C});S.group({n:"G2",ry:0});S.R({v:"G2",w:.1,J:1,d:.1,x:0,y:.5,U:1,b:A});range.addEventListener("input",this.j);submit.addEventListener("click",this.la)}N(){S.reset(c2d);S.clearColor(B);
document.removeEventListener("input",this.j);controls.classList.remove("slide")}K(){this.h++;60<this.h&&(this.h=0);S.move({n:"G1",x:-.5,y:-.5,ca:30*Math.cos(2*Math.PI*this.h/60)});S.move({n:"G2",x:.5,y:-.5,ca:30*this.l*Math.cos(2*Math.PI*this.h/60)});this.counter++;if(20<this.counter){this.counter=0;let b=Math.round(5*(1-Math.abs(1-this.l)/1.5));this.C=b;for(let c=0;5>c;c++)lights.children[c].classList.toggle("on",b>=c+1)}}}let ba=new aa;class ca{I(){t.o(ba)}K(){}}let da=new ca;
class ea{I(){intro.classList.remove("hide");play.addEventListener("click",this.h)}N(){intro.classList.add("hide");play.removeEventListener("click",this.h)}K(){n.B&&!n.l.B&&this.h()}h(){t.o(da)}}let fa=new ea;
class ha{constructor(){this.h=0;this.buttons=[this.j,this.l,this.C]}I(){menu.classList.remove("hide");start.addEventListener("click",this.j);contGame.addEventListener("click",this.l);fullscreen.addEventListener("click",this.C)}N(){menu.classList.add("hide");start.removeEventListener("click",this.j);contGame.removeEventListener("click",this.l);fullscreen.removeEventListener("click",this.C)}K(){n.G&&!n.l.G&&(this.h--,0>this.h&&(this.h=this.buttons.length-1));n.F&&!n.l.F&&(this.h++,this.h>=this.buttons.length&&
(this.h=0));if(n.B&&!n.l.B){let b=this.buttons[this.h];b&&b()}}j(){t.o(fa)}l(){}C(){document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen()}}let r=new ha;document.querySelector('link[type="image/x-icon"]').href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='.9em' font-size='90'%3E\ud83d\udd35%3C/text%3E%3C/svg%3E";t=new q(...[]);let X=0,Y=1E3/60,Z=[];
(function ia(b){let d=b-X;d>=Y&&(X=b-d%Y,a(),t.h.K(),Z.push(1E3/d),15===Z.length&&(fps.innerHTML=`${Math.round(Z.reduce((e,h)=>e+h)/15)} FPS`,Z=[]));requestAnimationFrame(ia)})(0);
